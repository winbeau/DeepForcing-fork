# Deep Forcing å¿«é€Ÿå¼€å§‹

## ğŸ¯ å½“å‰çŠ¶æ€

**ä»£ç å‘å¸ƒçŠ¶æ€ï¼š** âŒ æœªå‘å¸ƒ
**ä½ çš„ç¡¬ä»¶é…ç½®ï¼š** âœ… 48GB L40 Ã— 1ï¼ˆæ»¡è¶³éœ€æ±‚ï¼‰
**å‡†å¤‡ç¨‹åº¦ï¼š** å¯ä»¥å¼€å§‹å‡†å¤‡ç¯å¢ƒ

---

## âš¡ ä¸‰æ­¥å¿«é€Ÿå‡†å¤‡

### 1ï¸âƒ£ å®‰è£…åŸºç¡€ç¯å¢ƒï¼ˆ5åˆ†é’Ÿï¼‰

```bash
# æ¿€æ´»æˆ–åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
conda create -n deepforcing python=3.10 -y
conda activate deepforcing

# å®‰è£…PyTorchï¼ˆæ ¹æ®ä½ çš„CUDAç‰ˆæœ¬ï¼Œè¿™é‡Œå‡è®¾CUDA 12.1ï¼‰
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121

# å®‰è£…åŸºç¡€ä¾èµ–
pip install diffusers transformers accelerate
pip install opencv-python pillow imageio imageio-ffmpeg
pip install einops timm
```

### 2ï¸âƒ£ ä¸‹è½½åŸºç¡€æ¨¡å‹ï¼ˆ10-30åˆ†é’Ÿï¼‰

```bash
# å®‰è£…huggingface-cli
pip install -U huggingface-hub

# ä¸‹è½½CogVideoX-5Bï¼ˆæ¨èï¼Œçº¦26GBæ˜¾å­˜éœ€æ±‚ï¼‰
huggingface-cli download THUDM/CogVideoX-5b --local-dir ./models/CogVideoX-5b

# æˆ–è€…ä¸‹è½½2Bç‰ˆæœ¬ï¼ˆå¦‚æœæƒ³èŠ‚çœæ˜¾å­˜ï¼‰
# huggingface-cli download THUDM/CogVideoX-2b --local-dir ./models/CogVideoX-2b
```

### 3ï¸âƒ£ è®¾ç½®è‡ªåŠ¨ç›‘æ§ï¼ˆ1åˆ†é’Ÿï¼‰

```bash
cd /workspace/Projects/DeepForcing-fork

# å¯åŠ¨åå°ç›‘æ§ï¼ˆæ¯2å°æ—¶æ£€æŸ¥ä¸€æ¬¡ä»£ç æ›´æ–°ï¼‰
nohup ./monitor_loop.sh > monitor.log 2>&1 &

# æŸ¥çœ‹ç›‘æ§çŠ¶æ€
tail -f monitor.log

# æˆ–è€…æ‰‹åŠ¨æ£€æŸ¥ä¸€æ¬¡
./check_updates.sh
```

---

## ğŸ” ç›‘æ§ä»£ç å‘å¸ƒ

å·²ä¸ºä½ åˆ›å»ºäº†ä¸‰ä¸ªç›‘æ§è„šæœ¬ï¼š

| è„šæœ¬ | ç”¨é€” | ä½¿ç”¨æ–¹æ³• |
|------|------|----------|
| `check_updates.sh` | æ‰‹åŠ¨æ£€æŸ¥æ›´æ–° | `./check_updates.sh` |
| `monitor_loop.sh` | åå°æŒç»­ç›‘æ§ | `nohup ./monitor_loop.sh &` |
| `setup_monitoring.sh` | é…ç½®å®šæ—¶ä»»åŠ¡ | `./setup_monitoring.sh` |

### æ¨èæ–¹å¼ï¼šåå°ç›‘æ§

```bash
# å¯åŠ¨ï¼ˆæ¯2å°æ—¶è‡ªåŠ¨æ£€æŸ¥ï¼‰
nohup /workspace/Projects/DeepForcing-fork/monitor_loop.sh > monitor.log 2>&1 &

# æŸ¥çœ‹æ—¥å¿—
tail -f /workspace/Projects/DeepForcing-fork/monitor.log

# åœæ­¢ç›‘æ§
pkill -f monitor_loop.sh
```

---

## ğŸ“š å­¦ä¹ ç›¸å…³ä»£ç 

åœ¨ç­‰å¾…æœŸé—´ï¼Œç ”ç©¶è¿™äº›å·²å¼€æºçš„ç›¸å…³å·¥ä½œï¼š

### Self-Forcingï¼ˆæœ€ç›¸å…³ï¼‰

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/guandeh17/Self-Forcing.git
cd Self-Forcing

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# ç ”ç©¶é‡ç‚¹ï¼š
# 1. KVç¼“å­˜æœºåˆ¶ï¼ˆsrc/models/attention.pyï¼‰
# 2. æµå¼ç”Ÿæˆæµç¨‹ï¼ˆsrc/inference/streaming.pyï¼‰
# 3. è‡ªå›å½’è§†é¢‘ç”Ÿæˆï¼ˆsrc/models/video_diffusion.pyï¼‰
```

è¿™å¯¹ç†è§£Deep Forcingçš„æ ¸å¿ƒæœºåˆ¶å¾ˆæœ‰å¸®åŠ©ï¼

---

## ğŸ§ª é¢„æœŸä½¿ç”¨æµç¨‹ï¼ˆä»£ç å‘å¸ƒåï¼‰

### åŸºç¡€æ¨ç†

```bash
# ç”Ÿæˆ5ç§’è§†é¢‘ï¼ˆåŸºçº¿ï¼‰
python inference.py \
  --prompt "A stylish woman strolls down a bustling Tokyo street..." \
  --duration 5 \
  --output tokyo_5s.mp4
```

### Deep Forcingé•¿è§†é¢‘ç”Ÿæˆ

```bash
# ç”Ÿæˆ60ç§’è§†é¢‘
python inference.py \
  --prompt "A stylish woman strolls down a bustling Tokyo street..." \
  --duration 60 \
  --use_deep_sink \
  --sink_size 14 \
  --use_participative_compression \
  --output tokyo_60s.mp4
```

### å…³é”®å‚æ•°

- **sink_size**: 12-14ï¼ˆæœ€ä½³èŒƒå›´ï¼‰
  - å¤ªå°ï¼ˆ<9ï¼‰ï¼šè´¨é‡é€€åŒ–
  - å¤ªå¤§ï¼ˆ>15ï¼‰ï¼šé‡å¤è¿‡å¤š
- **duration**: 5-60ç§’
- **compression_top_c**: 50å·¦å³

---

## âš ï¸ å¸¸è§é—®é¢˜é¢„é˜²

### é—®é¢˜1ï¼šOOMé”™è¯¯

```python
# è§£å†³æ–¹æ¡ˆï¼šåœ¨é…ç½®ä¸­æ·»åŠ 
config = {
    "mixed_precision": "fp16",
    "enable_xformers": True,
    "enable_vae_slicing": True,
}
```

### é—®é¢˜2ï¼šæ˜¾å­˜ä¸å¤Ÿ

ä½ çš„48GB L40å®Œå…¨å¤Ÿç”¨ï¼Œä½†å¦‚æœé‡åˆ°é—®é¢˜ï¼š
- ä½¿ç”¨CogVideoX-2Bä»£æ›¿5B
- å¯ç”¨æ¨¡å‹å¸è½½ï¼ˆCPU offloadingï¼‰
- å‡å°batch size

### é—®é¢˜3ï¼šç”Ÿæˆé€Ÿåº¦æ…¢

- ä½¿ç”¨æ··åˆç²¾åº¦ï¼ˆfp16/bf16ï¼‰
- å¯ç”¨flash attention
- è€ƒè™‘æ¨¡å‹è’¸é¦ç‰ˆæœ¬

---

## ğŸ“ è·å–æ›´æ–°é€šçŸ¥

### æ–¹æ³•1ï¼šGitHub Watch

1. è®¿é—® https://github.com/cvlab-kaist/DeepForcing
2. ç‚¹å‡»å³ä¸Šè§’ "Watch" â†’ "All Activity"
3. åœ¨ Settings â†’ Notifications ä¸­é…ç½®é‚®ä»¶é€šçŸ¥

### æ–¹æ³•2ï¼šè‡ªåŠ¨ç›‘æ§è„šæœ¬

å·²ä¸ºä½ é…ç½®å¥½ï¼Œè¿è¡Œï¼š

```bash
nohup /workspace/Projects/DeepForcing-fork/monitor_loop.sh > monitor.log 2>&1 &
```

### æ–¹æ³•3ï¼šå…³æ³¨ä½œè€…

- KAIST CV Lab: https://cvlab.kaist.ac.kr
- é¡¹ç›®é¡µé¢å®šæœŸè®¿é—®: https://cvlab-kaist.github.io/DeepForcing/

---

## âœ… å‡†å¤‡æ£€æŸ¥æ¸…å•

- [ ] Python 3.10 ç¯å¢ƒå·²åˆ›å»º
- [ ] PyTorch + CUDA å·²å®‰è£…
- [ ] åŸºç¡€ä¾èµ–å·²å®‰è£…ï¼ˆdiffusers, transformersç­‰ï¼‰
- [ ] CogVideoXæ¨¡å‹å·²ä¸‹è½½
- [ ] ç›‘æ§è„šæœ¬å·²å¯åŠ¨
- [ ] å·²å­¦ä¹ Self-Forcingä»£ç 
- [ ] æµ‹è¯•æç¤ºè¯å·²å‡†å¤‡
- [ ] GPUç›‘æ§å·¥å…·å·²é…ç½®ï¼ˆnvidia-smi, gpustatï¼‰

---

## ğŸš€ ä»£ç å‘å¸ƒåçš„ç¬¬ä¸€æ—¶é—´è¡ŒåŠ¨

1. **ç«‹å³æ‹‰å–ä»£ç **
   ```bash
   cd /workspace/Projects/DeepForcing-fork
   git pull origin master
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   pip install -r requirements.txt
   ```

3. **è¿è¡Œå¿«é€Ÿæµ‹è¯•**
   ```bash
   # ä½¿ç”¨é¡¹ç›®æä¾›çš„demoè„šæœ¬
   python demo.py  # æˆ– bash run_demo.sh
   ```

4. **å¼€å§‹å¤ç°å®éªŒ**
   - å…ˆè¿è¡Œç®€å•çš„5ç§’ç”Ÿæˆæµ‹è¯•
   - å†å°è¯•60ç§’é•¿è§†é¢‘
   - å¯¹æ¯”ä¸åŒsink_sizeçš„æ•ˆæœ
   - è®°å½•æ€§èƒ½æŒ‡æ ‡

---

**å‡†å¤‡å®Œæˆï¼ç­‰å¾…ä»£ç å‘å¸ƒ... ğŸ“¬**

æŸ¥çœ‹è¯¦ç»†æŒ‡å—ï¼š`å¤ç°æŒ‡å—.md`
